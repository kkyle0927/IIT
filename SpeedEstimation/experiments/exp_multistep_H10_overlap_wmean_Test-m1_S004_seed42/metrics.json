{
    "test_huber": 0.0006922581045934996,
    "test_mae": 0.022233590483665466,
    "test_rmse": 0.03770681470632553,
    "n_params": 401766,
    "model_size_mb": 1.5326,
    "host_latency_ms": 2.5053,
    "host_max_freq_hz": 399.15,
    "config": {
        "shared": {
            "data_sources": {
                "milestone1": {
                    "path": "./combined_data_milestone1.h5",
                    "prefix": "m1_",
                    "exclude_subjects": [
                        "S001",
                        "S002",
                        "S003"
                    ]
                },
                "milestone2": {
                    "path": "./combined_data.h5",
                    "prefix": "m2_",
                    "exclude_subjects": []
                }
            },
            "subjects": [
                "m1_S004",
                "m1_S005",
                "m1_S006",
                "m1_S007",
                "m1_S008",
                "m1_S009",
                "m1_S010",
                "m1_S011",
                "m2_S001",
                "m2_S002",
                "m2_S003",
                "m2_S004",
                "m2_S005",
                "m2_S006",
                "m2_S007",
                "m2_S008"
            ],
            "conditions": [
                "level_08mps",
                "level_12mps",
                "level_16mps",
                "level_075mps",
                "level_100mps",
                "level_125mps",
                "accel_sine",
                "decline_5deg",
                "incline_10deg",
                "stopandgo"
            ],
            "input_vars": [
                [
                    "mocap/kin_q",
                    [
                        "hip_flexion_l",
                        "hip_flexion_r",
                        "knee_angle_l",
                        "knee_angle_r",
                        "ankle_angle_l",
                        "ankle_angle_r"
                    ]
                ],
                [
                    "mocap/kin_q",
                    [
                        "hip_flexion_l_dot",
                        "hip_flexion_r_dot",
                        "knee_angle_l_dot",
                        "knee_angle_r_dot",
                        "ankle_angle_l_dot",
                        "ankle_angle_r_dot"
                    ]
                ],
                [
                    "mocap/kin_q",
                    [
                        "hip_flexion_l_ddot",
                        "hip_flexion_r_ddot",
                        "knee_angle_l_ddot",
                        "knee_angle_r_ddot",
                        "ankle_angle_l_ddot",
                        "ankle_angle_r_ddot"
                    ]
                ],
                [
                    "robot/back_imu",
                    [
                        "accel_x",
                        "accel_y",
                        "accel_z",
                        "gyro_x",
                        "gyro_y",
                        "gyro_z"
                    ]
                ],
                [
                    "forceplate/grf/left",
                    [
                        "x",
                        "y",
                        "z"
                    ]
                ],
                [
                    "forceplate/grf/right",
                    [
                        "x",
                        "y",
                        "z"
                    ]
                ]
            ],
            "output_vars": [
                [
                    "treadmill/left",
                    [
                        "speed_leftbelt"
                    ]
                ]
            ],
            "lpf_cutoff": 0.5,
            "lpf_order": 4,
            "data": {
                "window_size": 300,
                "stride": 5,
                "stride_inf": 1,
                "y_delay": 5,
                "est_tick_ranges": [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10
                ],
                "normalize": true,
                "time_window_output": 10
            },
            "model": {
                "type": "TCN",
                "channels": [
                    32,
                    32,
                    64,
                    64,
                    128,
                    128
                ],
                "kernel_size": 5,
                "dropout": 0.2,
                "use_norm": true,
                "head_hidden": [
                    64
                ],
                "head_dropout": 0.5,
                "model_norm": "layer",
                "use_input_norm": true,
                "norm_type": "layer",
                "gating_signal": null,
                "attention_type": null,
                "attention_heads": 0
            }
        },
        "02_train": {
            "data": {
                "window_size": 300,
                "stride": 5,
                "stride_inf": 1,
                "y_delay": 5,
                "est_tick_ranges": [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10
                ],
                "normalize": true,
                "time_window_output": 10,
                "normalize_type": "standard",
                "use_physical_velocity_model": false,
                "use_gait_phase": false
            },
            "model": {
                "type": "TCN",
                "channels": [
                    32,
                    32,
                    64,
                    64,
                    128,
                    128
                ],
                "kernel_size": 5,
                "dropout": 0.2,
                "use_norm": true,
                "head_hidden": [
                    64
                ],
                "head_dropout": 0.5,
                "model_norm": "layer",
                "use_input_norm": true,
                "norm_type": "layer",
                "gating_signal": null,
                "attention_type": null,
                "attention_heads": 0
            },
            "loader": {
                "batch_size": 128,
                "val_batch_size": 256
            },
            "train": {
                "task_type": "regression",
                "loss": "huber",
                "huber_delta": 0.1,
                "loss_penalty": null,
                "loss_penalty_weight": 0.0,
                "loss_penalty_cutoff": null,
                "epochs": 30,
                "lr": 0.001,
                "wd": 0.001,
                "amp": true,
                "device": "cuda",
                "save_dir": "./runs_tcn",
                "early_stop_patience": 10,
                "early_stop_min_delta": "1e-04",
                "early_stop_warmup": 10,
                "k_fold": 4,
                "cos_T0": 10,
                "cos_Tmult": 1,
                "eta_min": 1e-05,
                "augment_noise_std": 0.03,
                "smoothness_loss_weight": 0.0,
                "kinematic_loss_weight_pos": 0.0,
                "kinematic_loss_weight_limit": 0,
                "kinematic_loss_degrees": false,
                "kinematic_loss_tolerance": 0.05,
                "train_loss_target": 0.0
            }
        },
        "03_eval": {
            "split": {
                "mode": "loso",
                "level": "subject",
                "seed": 42,
                "ratio": [
                    0.7,
                    0.15,
                    0.15
                ],
                "manual": {
                    "val": [
                        "m2_S007"
                    ],
                    "test": [
                        "m2_S008"
                    ]
                },
                "save_to": null,
                "loso_subjects": [
                    "m1_S004",
                    "m2_S008",
                    "m1_S011"
                ]
            },
            "data": {
                "window_size": 300,
                "stride": 5,
                "stride_inf": 1,
                "y_delay": 5,
                "est_tick_ranges": [
                    1,
                    2,
                    3,
                    4,
                    5,
                    6,
                    7,
                    8,
                    9,
                    10
                ],
                "normalize": true,
                "time_window_output": 10
            },
            "train": {
                "device": "cuda"
            },
            "scaler_path": "./runs_tcn/scaler.npz",
            "overlap_ensemble": {
                "enable": true,
                "method": "weighted_mean",
                "weights_decay": 0.8
            }
        },
        "exp_name": "exp_multistep_H10_overlap_wmean",
        "cv_mode": "loso",
        "subjects": [
            "m1_S004",
            "m1_S005",
            "m1_S006",
            "m1_S007",
            "m1_S008",
            "m1_S009",
            "m1_S010",
            "m1_S011",
            "m2_S001",
            "m2_S002",
            "m2_S003",
            "m2_S004",
            "m2_S005",
            "m2_S006",
            "m2_S007",
            "m2_S008"
        ],
        "data_path": "./combined_data.h5",
        "conditions": [
            "level_08mps",
            "level_12mps",
            "level_16mps",
            "level_075mps",
            "level_100mps",
            "level_125mps",
            "accel_sine",
            "decline_5deg",
            "incline_10deg",
            "stopandgo"
        ],
        "est_tick_ranges": [
            5
        ],
        "tcn_channels": [
            32,
            32,
            64,
            64,
            128,
            128
        ]
    },
    "multistep_detail": {
        "H1_mae": 0.02218620479106903,
        "H1_rmse": 0.037663452327251434,
        "H2_mae": 0.02219902165234089,
        "H2_rmse": 0.03767378255724907,
        "H3_mae": 0.022210050374269485,
        "H3_rmse": 0.03768390044569969,
        "H4_mae": 0.022221244871616364,
        "H4_rmse": 0.03769490867853165,
        "H5_mae": 0.022233590483665466,
        "H5_rmse": 0.03770681470632553,
        "H6_mae": 0.02224658988416195,
        "H6_rmse": 0.03772006928920746,
        "H7_mae": 0.022260278463363647,
        "H7_rmse": 0.037734661251306534,
        "H8_mae": 0.022273806855082512,
        "H8_rmse": 0.03774959594011307,
        "H9_mae": 0.022287247702479362,
        "H9_rmse": 0.037764959037303925,
        "H10_mae": 0.02230132929980755,
        "H10_rmse": 0.03778199478983879
    }
}